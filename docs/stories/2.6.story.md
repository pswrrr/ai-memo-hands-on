# Story 2.6: 노트 삭제 및 복구

## Status
Draft

## Story
**As a** 사용자,
**I want** 불필요한 노트를 삭제하고 실수로 삭제한 노트를 복구할 수 있도록,
**so that** 노트를 안전하게 관리할 수 있다

## Acceptance Criteria
1. 사용자는 노트 상세 페이지에서 삭제 버튼을 클릭하여 노트를 삭제할 수 있다
2. 삭제 전 확인 다이얼로그가 표시된다
3. 삭제된 노트는 즉시 목록에서 사라진다
4. 삭제된 노트는 30일간 휴지통에 보관된다
5. 휴지통에서 삭제된 노트를 복구할 수 있다
6. 휴지통에서 영구 삭제할 수 있다
7. 다른 사용자의 노트는 삭제할 수 없다
8. 삭제/복구 작업 후 적절한 피드백 메시지가 표시된다
9. 로딩 상태가 표시된다
10. 에러 발생 시 사용자에게 적절한 메시지가 표시된다

## Tasks / Subtasks
- [ ] 노트 삭제 서버 액션 구현 (AC: 1, 3, 4, 7)
  - [ ] deleteNote 서버 액션 생성
  - [ ] 사용자 권한 검증
  - [ ] 소프트 삭제 로직 구현
  - [ ] 휴지통 테이블 생성
- [ ] 노트 복구 서버 액션 구현 (AC: 5, 7)
  - [ ] restoreNote 서버 액션 생성
  - [ ] 권한 검증
  - [ ] 복구 로직 구현
- [ ] 영구 삭제 서버 액션 구현 (AC: 6, 7)
  - [ ] permanentDeleteNote 서버 액션 생성
  - [ ] 권한 검증
  - [ ] 영구 삭제 로직 구현
- [ ] 삭제 확인 다이얼로그 구현 (AC: 2, 8, 9, 10)
  - [ ] DeleteConfirmDialog 컴포넌트 생성
  - [ ] 확인/취소 버튼 구현
  - [ ] 로딩/에러 상태 처리
- [ ] 휴지통 UI 구현 (AC: 4, 5, 6)
  - [ ] TrashPage 컴포넌트 생성
  - [ ] 삭제된 노트 목록 표시
  - [ ] 복구/영구삭제 버튼 구현
- [ ] 데이터베이스 스키마 업데이트 (AC: 4)
  - [ ] 휴지통 테이블 스키마 정의
  - [ ] 마이그레이션 생성
- [ ] 테스트 구현 (AC: 1-10)
  - [ ] 서버 액션 테스트
  - [ ] 컴포넌트 테스트
  - [ ] 권한 검증 테스트
  - [ ] 휴지통 로직 테스트

## Dev Notes

### Relevant Source Tree Info
- `app/dashboard/trash/page.tsx` - 휴지통 페이지
- `app/actions/notes.ts` - 노트 관련 서버 액션
- `lib/db/schema.ts` - 데이터베이스 스키마
- `components/notes/` - 노트 관련 컴포넌트들
- `components/ui/` - shadcn/ui 컴포넌트들

### Testing
- **Test file location**: `__tests__/`
- **Test standards**: Jest + Testing Library 사용
- **Testing frameworks**: 
  - Unit tests: Jest
  - Component tests: @testing-library/react
  - Integration tests: Jest
- **Specific testing requirements**:
  - 소프트 삭제 로직 테스트
  - 휴지통 복구 로직 테스트
  - 권한 검증 테스트
  - 삭제 확인 다이얼로그 테스트

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-01-14 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be added here*
