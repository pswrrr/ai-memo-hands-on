# Story 2.4: 노트 상세 조회

## Status
Done

## Story
**As a** 사용자,
**I want** 특정 노트의 상세 내용을 조회할 수 있도록,
**so that** 노트의 전체 내용을 읽고 필요시 수정할 수 있다

## Acceptance Criteria
1. 사용자는 노트 목록에서 노트를 클릭하여 상세 페이지로 이동할 수 있다
2. 노트 상세 페이지에는 제목, 본문, 작성일, 수정일이 표시된다
3. 노트 본문은 전체 내용이 표시되며, 긴 내용의 경우 스크롤이 가능하다
4. 노트 상세 페이지에는 수정 버튼과 삭제 버튼이 표시된다
5. 뒤로가기 버튼이 있어 대시보드로 돌아갈 수 있다
6. 존재하지 않는 노트에 접근할 경우 404 페이지가 표시된다
7. 다른 사용자의 노트에 접근할 경우 권한 없음 메시지가 표시된다
8. 로딩 상태가 표시된다
9. 에러 발생 시 사용자에게 적절한 메시지가 표시된다

## Tasks / Subtasks
- [x] 노트 상세 조회 서버 액션 구현 (AC: 1, 6, 7)
  - [x] getNoteById 서버 액션 생성
  - [x] 사용자 권한 검증 로직
  - [x] 노트 존재 여부 확인
- [x] 노트 상세 페이지 구현 (AC: 2, 3, 4, 5, 8, 9)
  - [x] NoteDetail 컴포넌트 생성
  - [x] 노트 메타데이터 표시
  - [x] 액션 버튼들 구현
  - [x] 로딩/에러 상태 처리
- [x] 라우팅 설정 (AC: 1)
  - [x] `/dashboard/notes/[id]` 동적 라우트 생성
  - [x] 404 페이지 처리
- [x] 테스트 구현 (AC: 1-9)
  - [x] 서버 액션 테스트
  - [x] 컴포넌트 테스트
  - [x] 권한 검증 테스트

## Dev Notes

### Relevant Source Tree Info
- `app/dashboard/notes/[id]/page.tsx` - 노트 상세 페이지
- `app/actions/notes.ts` - 노트 관련 서버 액션
- `lib/db/schema.ts` - 노트 데이터베이스 스키마
- `components/ui/` - shadcn/ui 컴포넌트들

### Testing
- **Test file location**: `__tests__/`
- **Test standards**: Jest + Testing Library 사용
- **Testing frameworks**: 
  - Unit tests: Jest
  - Component tests: @testing-library/react
  - Integration tests: Jest
- **Specific testing requirements**:
  - 서버 액션의 권한 검증 로직 테스트
  - 404 및 권한 없음 시나리오 테스트
  - 컴포넌트의 로딩/에러 상태 테스트

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-01-14 | 1.0 | Initial story creation | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
Claude 3.5 Sonnet (2024-01-14)

### Debug Log References
- 동적 라우트 설정 시 Next.js 15의 새로운 라우팅 구조 적용
- 서버 액션에서 사용자 권한 검증 로직 최적화
- 404 페이지 처리에서 notFound() 함수 활용

### Completion Notes List
- **서버 액션 구현**: getNoteById 함수에서 사용자 인증과 권한 검증을 통합하여 구현
- **동적 라우팅**: Next.js App Router의 동적 라우트 구조를 활용하여 `/dashboard/notes/[id]` 경로 구현
- **404 처리**: notFound() 함수를 사용하여 존재하지 않는 노트에 대한 적절한 404 응답 처리
- **권한 검증**: 노트 소유권을 확인하여 다른 사용자의 노트 접근을 차단
- **UI/UX 개선**: 로딩 상태, 에러 상태, 빈 상태를 명확히 구분하여 사용자 경험 향상
- **테스트 커버리지**: 서버 액션과 컴포넌트에 대한 포괄적인 테스트 작성

### File List
**생성된 파일:**
- `app/dashboard/notes/[id]/page.tsx` - 노트 상세 페이지 (동적 라우트)
- `app/dashboard/notes/[id]/not-found.tsx` - 404 페이지
- `components/notes/NoteDetail.tsx` - 노트 상세 컴포넌트
- `__tests__/get-note-by-id.test.ts` - 서버 액션 테스트
- `__tests__/NoteDetail.test.tsx` - 컴포넌트 테스트

**수정된 파일:**
- `app/actions/notes.ts` - getNoteById 서버 액션 추가

## QA Results
*Results from QA Agent review will be added here*
